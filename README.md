# LMLiveStreaming
å‰å¼•ï¼šç›®å‰ç›´æ’­åŒ…å«é‡‡é›†ç«¯ä¸æ’­æ”¾ç«¯ï¼Œæ’­æ”¾ç«¯ç›®å‰å¼€æºæ¯”è¾ƒå¥½ç”¨çš„æ˜¯bilibiliæ’­æ”¾å™¨ï¼Œç½‘å€ä¸ºhttps://github.com/Bilibili/ijkplayerï¼Œæ”¯æŒäº†å¾ˆå¤šçš„æ ¼å¼ï¼Œå…¶ä¸­åŒ…å«äº†RTMPæ ¼å¼ï¼Œéå¸¸çš„ğŸ‘

èµ·å› ï¼šæˆ‘è¿™é‡Œå¤„ç†çš„æ˜¯éŸ³è§†é¢‘é‡‡é›†ç«¯ï¼Œç›®å‰å¼€æºç¤¾åŒºæ¯”è¾ƒç«çš„æ˜¯LiveVideoCoreSDKï¼ˆhttps://github.com/search?utf8=âœ“&q=LiveVideoCore&type=Repositories&ref=searchresultsï¼‰ï¼Œå…¶ä¸­å€Ÿé‰´äº†videoCoreï¼ˆhttps://github.com/jgh-/VideoCoreï¼‰ï¼Œè¿™ä¸ªå¤–å›½äººå†™çš„ï¼Œä½†æ— å¥ˆéƒ½æ˜¯C++ï¼Œiosé‡‡é›†è¿™è¾¹ç›®å‰ä¸€èˆ¬éƒ½æ˜¯SDKï¼Œå½“å‰æˆ‘ä¹Ÿæ˜¯å€Ÿé‰´äº†å¾ˆå¤šçš„SDKä¸VideoCoreï¼Œå†™äº†ç›®å‰è¿™ä¸ªLMLiveStreamingã€‚

æ¶æ„ï¼šåˆ†ä¸ºé‡‡é›†ï¼ï¼ï¼>ç¼–ç --->æ‰“åŒ…ä¸Šä¼   æˆ‘è¿™è¾¹ä¸ºäº†æ›´å¥½çš„æ‰©å±•ï¼Œåœ¨ç¼–ç æ‰“åŒ…ä»¥åŠä¸Šä¼ è¿™å‡ ä¸ªæ¨¡å—é€šè¿‡åè®®æŠ½è±¡äº†ç›¸å…³çš„æ–¹æ³•ï¼Œåœ¨æ»¤é•œæ–¹é¢ç”¨çš„GPUImageï¼Œç¾é¢œå¤§å®¶å¯ä»¥å‚è€ƒBeautifyFaceDemoï¼ˆhttps://github.com/Guikunzhi/BeautifyFaceDemoï¼‰

åŠŸèƒ½ï¼šç›®å‰æ”¯æŒFLVä¸Šä¼ äºRTMPä¸Šä¼ ï¼Œçœ‹åˆ°æ˜ å®¢ç›®å‰ä¹Ÿæ˜¯æ”¯æŒäº†2ç§ï¼Œä¸Šä¼ å…¶ä¸­ä¸€ç§åœ¨æœåŠ¡å™¨è¿›è¡Œè½¬ç ã€‚æ”¯æŒios8ä»¥ä¸ŠéŸ³é¢‘è§†é¢‘ç¡¬ä»¶ç¼–ç ï¼Œå¦‚æœæœ‰éœ€è¦å¯ä»¥åé¦ˆï¼ˆios7åŠ ä¸Šè½¯ç¼–ç ï¼‰ï¼ŒéŸ³é¢‘ä¸ºAACï¼ˆiphone6sä»¥ä¸Šé‡‡é›†48Kï¼Œå…¶ä½™æ”¯æŒ44.1Kï¼‰ï¼Œè§†é¢‘ä¸ºH264ï¼Œæ”¯æŒäº†å¼±ç½‘ä¸¢å¸§ï¼ŒåŠ¨æ€çš„åˆ‡æ¢ç ç‡ä¸åˆ†è¾¨ç‡ï¼Œä½†æ˜¯åˆ‡æ¢åˆ†è¾¨ç‡å¤§å®¶ä¸€å®šè¦å°å¿ƒï¼Œå› ä¸ºæ’­æ”¾ç«¯çœ‹ç€ä½“éªŒä¸ä¼šå¤ªå¥½ã€‚

ç›®å‰é—®é¢˜ï¼šç›®å‰åœ¨tcpä¼ è¾“FLVåšäº†æ–­ç½‘é‡è¿ï¼Œä½†RTMPç›®å‰æ²¡æœ‰å®ç°ï¼ŒRTMPä¼ è¾“çš„å»¶è¿Ÿæ¯”è¾ƒå¤§ï¼Œä¸€èˆ¬ä¸º3Såˆ°10å‡ ç§’ä¸ç­‰ã€‚

è¿‘æœŸéœ€è¦è§£å†³ï¼šGPUImageå®ç°æ°´å°ï¼ŒRTMPæ–­ç½‘é‡è¿

æœªæ¥å±•æœ›ï¼šUDPä¼ è¾“ï¼Œä¾‹å¦‚RTPï¼ŒRTSPï¼Œæˆ–è€…è‡ªå·±æ§åˆ¶é‡ä¼ åè®®ç­‰ï¼Œè¿˜æœ‰æ··éŸ³ã€‚

æœåŠ¡å™¨æ­å»ºï¼š å¯¹äºåˆå­¦ç›´æ’­çš„åŒå­¦æ²¡æœ‰RTMPæœåŠ¡å™¨è¿˜çœŸã€‚ã€‚ã€‚ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹RTMPï¼‹nginxæœåŠ¡å™¨ã€‚
é¦–å…ˆä¸‹è½½nginxæºç ï¼Œå»nginx.orgä¸‹è½½ï¼Œå…¶æ¬¡ä¸‹è½½nginx-rtmp-module-masterï¼ˆhttps://github.com/arut/nginx-rtmp-moduleï¼‰ä»£ç ï¼Œå†å»ä¸‹è½½openssï¼ˆopenss.orgï¼‰ï¼Œç„¶åä¿®æ”¹openssl makefileï¼Œå°†PLATFORM=distæ”¹ä¸ºPLATFORM=darwin64-x86_64-ccï¼Œç„¶åcdåˆ°nginxæºç ç›®å½•ï¼Œæ‰§è¡Œexport KERNEL_BITS=64 ç„¶åå†æ‰§è¡Œ./configure --add-module= nginx-rtmp-module-masterdeçš„è·¯å¾„ --with-openssl= oepnsslæºç è·¯å¾„ï¼Œç„¶åmake install.æœ€åæŸ¥æ‰¾nginx.confé»˜è®¤åªæ”¯æŒhttpï¼Œæ·»åŠ ä¸‹é¢ä»£ç å†æ¬¡å¯åŠ¨å°±å¥½äº†ã€‚
rtmp {
    server {
            listen 1935;

        #ç‚¹æ’­é…ç½®
                application vod {
                    play /opt/media/nginxrtmp/flv;
                }
        
        #ç›´æ’­æµé…ç½®
            application live {
                    live on;
            #ä¸º rtmp å¼•æ“è®¾ç½®æœ€å¤§è¿æ¥æ•°ã€‚é»˜è®¤ä¸º off
            max_connections 1024;

                    # default recorder
                    record all;
                    record_path /var/rec;
 
                    recorder audio {
                         record audio;
                         record_suffix -%d-%b-%y-%T.flv;
                    } 

                    recorder chunked {
                        record all;
                         record_interval 15s;
                         record_path /var/rec/chunked;
                    }

            #on_publish http://localhost:8080/publish;  
            #on_play http://localhost:8080/play;  
            #on_record_done http://localhost:8080/record_done;
            
            #rtmpæ—¥å¿—è®¾ç½®
             #access_log logs/rtmp_access.log new;
             #access_log logs/rtmp_access.log;
             #access_log off;

             }
        
        #HLSåè®®æ”¯æŒ
        #application hls {  
            #live on;  
            #hls on;  
            #hls_path /tmp/app;  
            #hls_fragment 5s;  
        #} 

            application hls{
        
                    live on;
                    hls on;
                    hls_path /usr/local/nginx/html/app;
                    hls_fragment 1s;
            }
 

        }
	}



